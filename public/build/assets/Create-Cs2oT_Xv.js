import{d as F,u as $,m as w,c as C,w as n,a as o,b as i,e,h as D,f as d,t as l,g as j,i as m,j as _,n as v,o as f,F as V,k as B,r as g}from"./app-iB5JroHL.js";import{X as M,_ as N}from"./AppLayout.vue_vue_type_script_setup_true_lang-BjDdRGsn.js";import{_ as E,a as J,b as z,c as A}from"./CardTitle.vue_vue_type_script_setup_true_lang-BOdCY70B.js";import{_ as P}from"./CardDescription.vue_vue_type_script_setup_true_lang-DOygd7NC.js";import{_ as x}from"./index-X0dx6blS.js";import{_ as y}from"./Label.vue_vue_type_script_setup_true_lang-RTZaJV3S.js";import{_ as U}from"./Textarea.vue_vue_type_script_setup_true_lang-C-mz5mvU.js";import{_ as G}from"./Input.vue_vue_type_script_setup_true_lang-CcVhxJql.js";import{F as I}from"./file-up-C7mvjoQ2.js";import"./index-DDOeCoQC.js";import"./VisuallyHidden-CsxWP5mD.js";import"./useForwardExpose-DlFM9lJQ.js";import"./useForwardPropsEmits-CnK8L7VS.js";import"./users-C3V69xlN.js";const L={class:"py-12"},T={class:"max-w-3xl mx-auto sm:px-6 lg:px-8"},q={class:"mt-2"},X={class:"mt-1"},H={class:"space-y-2"},K={key:0,class:"text-sm text-red-500"},O={class:"space-y-2"},Q={class:"flex items-center gap-4"},R={key:0,class:"text-sm text-red-500"},W={key:1,class:"mt-4 space-y-2"},Y={class:"text-sm font-medium"},Z={class:"flex-1"},ee={class:"text-sm font-medium"},te={class:"text-xs text-muted-foreground"},se={class:"flex gap-3"},be=F({__name:"Create",props:{attendance:{}},setup(c){const s=$({attendance_id:c.attendance.id,description:"",files:[]}),p=w(null),h=a=>{const t=a.target;if(t.files){const r=Array.from(t.files),u=5-s.files.length,b=r.slice(0,u);s.files=[...s.files,...b]}p.value&&(p.value.value="")},S=a=>{s.files=s.files.filter((t,r)=>r!==a)},k=()=>{const a=new FormData;a.append("attendance_id",String(s.attendance_id)),a.append("description",s.description),s.files.forEach(t=>{a.append("files[]",t)}),g.post("/student/justifications",a,{onSuccess:()=>{g.visit("/student/justifications")},onError:t=>{console.error("Submission errors:",t),s.errors=t}})};return(a,t)=>(f(),C(N,null,{default:n(()=>[o(e(D),{title:"Submit Justification"}),i("div",L,[i("div",T,[o(e(E),null,{default:n(()=>[o(e(J),null,{default:n(()=>[o(e(z),null,{default:n(()=>[...t[2]||(t[2]=[d("Submit Justification for Absence",-1)])]),_:1}),o(e(P),null,{default:n(()=>[i("div",q,[t[3]||(t[3]=i("strong",null,"Module:",-1)),d(" "+l(c.attendance.module_code)+" - "+l(c.attendance.module),1)]),i("div",X,[t[4]||(t[4]=i("strong",null,"Date:",-1)),d(" "+l(new Date(c.attendance.date).toLocaleString()),1)])]),_:1})]),_:1}),o(e(A),null,{default:n(()=>[i("form",{onSubmit:j(k,["prevent"]),class:"space-y-6"},[i("div",H,[o(e(y),{for:"description"},{default:n(()=>[...t[5]||(t[5]=[d("Description",-1)])]),_:1}),o(e(U),{id:"description",modelValue:e(s).description,"onUpdate:modelValue":t[0]||(t[0]=r=>e(s).description=r),placeholder:"Explain the reason for your absence...",rows:"4",class:v({"border-red-500":e(s).errors.description}),required:""},null,8,["modelValue","class"]),e(s).errors.description?(f(),m("p",K,l(e(s).errors.description),1)):_("",!0),t[6]||(t[6]=i("p",{class:"text-xs text-muted-foreground"},"Maximum 1000 characters",-1))]),i("div",O,[o(e(y),{for:"files"},{default:n(()=>[...t[7]||(t[7]=[d("Supporting Documents",-1)])]),_:1}),i("div",Q,[o(e(G),{ref_key:"fileInput",ref:p,id:"files",type:"file",accept:".pdf,.jpg,.jpeg,.png",multiple:"",onChange:h,disabled:e(s).files.length>=5,class:v({"border-red-500":e(s).errors.files})},null,8,["disabled","class"]),o(e(I),{class:"h-5 w-5 text-muted-foreground"})]),e(s).errors.files?(f(),m("p",R,l(e(s).errors.files),1)):_("",!0),t[8]||(t[8]=i("p",{class:"text-xs text-muted-foreground"}," Upload 1-5 files (PDF, JPG, PNG). Maximum 10MB per file. ",-1)),e(s).files.length>0?(f(),m("div",W,[i("p",Y,"Selected Files ("+l(e(s).files.length)+"/5):",1),(f(!0),m(V,null,B(e(s).files,(r,u)=>(f(),m("div",{key:u,class:"flex items-center justify-between p-3 border rounded-lg"},[i("div",Z,[i("p",ee,l(r.name),1),i("p",te,l((r.size/1024/1024).toFixed(2))+" MB ",1)]),o(e(x),{type:"button",size:"sm",variant:"ghost",onClick:b=>S(u)},{default:n(()=>[o(e(M),{class:"h-4 w-4"})]),_:1},8,["onClick"])]))),128))])):_("",!0)]),i("div",se,[o(e(x),{type:"submit",disabled:e(s).processing||e(s).files.length===0},{default:n(()=>[d(l(e(s).processing?"Submitting...":"Submit Justification"),1)]),_:1},8,["disabled"]),o(e(x),{type:"button",variant:"outline",onClick:t[1]||(t[1]=r=>e(g).visit("/student/justifications"))},{default:n(()=>[...t[9]||(t[9]=[d(" Cancel ",-1)])]),_:1})])],32)]),_:1})]),_:1})])])]),_:1}))}});export{be as default};
